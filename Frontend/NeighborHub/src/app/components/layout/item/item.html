<div class="items-page">
  <header class="items-header">
    <h1 class="items-title">Items</h1>
    <p class="items-subtitle">Browse and book items from your neighbors</p>
  </header>

  @if (items.length === 0) {
    <div class="items-empty">
      <p>No items yet.</p>
    </div>
  } @else {
    <div class="items-grid">
      @for (item of paginatedItems; track item.id) {
        <article class="item-card">
          <div class="item-card-image-wrap">
            <img
              [src]="baseUrl + item.imageUrl"
              [alt]="item.name"
              class="item-card-image"
            />
            <span class="item-card-badge" [ngClass]="statusBadgeClass(item.itemStatus)">
              {{ statusLabel(item.itemStatus) }}
            </span>
          </div>
          <div class="item-card-body">
            <h2 class="item-card-title">{{ item.name }}</h2>
            <p class="item-card-desc">{{ item.description || 'No description' }}</p>
            <div class="item-card-meta">
              <span class="item-card-category">{{ item.category }}</span>
              <span class="item-card-owner">{{ item.ownerName }}</span>
            </div>
            <div class="item-card-footer">
              <button
                type="button"
                class="item-card-btn"
                (click)="openBookingModal(item.id)"
                [disabled]="item.itemStatus === 2"
              >
                {{ item.itemStatus === 2 ? 'Unavailable' : 'Book' }}
              </button>
            </div>
          </div>
        </article>
      }
    </div>

    @if (totalPages > 1) {
      <nav class="items-pagination" aria-label="Items pagination">
        <button
          type="button"
          class="btn btn-sm btn-ghost"
          (click)="prevPage()"
          [disabled]="currentPage <= 1"
          aria-label="Previous page"
        >
          ← Previous
        </button>
        <span class="items-pagination-info">
          Page {{ currentPage }} of {{ totalPages }}
          <span class="items-pagination-range">({{ startIndex }}–{{ endIndex }} of {{ items.length }})</span>
        </span>
        <button
          type="button"
          class="btn btn-sm btn-ghost"
          (click)="nextPage()"
          [disabled]="currentPage >= totalPages"
          aria-label="Next page"
        >
          Next →
        </button>
      </nav>
    }
  }
</div>

<dialog id="my_modal_3" class="modal">
  <div class="modal-box">
    <form method="dialog">
      <button type="button" class="btn btn-sm btn-circle btn-ghost absolute right-2 top-2">✕</button>
    </form>
    @if (selectedItemId) {
      <app-booking [item]="selectedItemId"></app-booking>
    }
  </div>
  <form method="dialog" class="modal-backdrop">
    <button type="submit">close</button>
  </form>
</dialog>
